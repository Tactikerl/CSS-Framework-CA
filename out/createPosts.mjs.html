<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: createPosts.mjs</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: createPosts.mjs</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { addToPosts } from "./currentPosts.mjs";
import { validURL } from "./utils.mjs";

/**
 *
 * @param {event} event on click event that sends the new post to the API
 * @returns - guards set up to prevent the title and the body text to be empty, so that there are no blank posts created.
 */
function submitPost(event) {
  event.preventDefault();

  const title = document.getElementById("inputTitle").value;
  const token = localStorage.getItem("token");

  const body = document.getElementById("inputBody").value;

  if (!token) {
    return;
  }

  if (!title || !body) {
    return;
  }

  var myHeaders = new Headers();
  myHeaders.append("Authorization", `Bearer ${token}`);
  myHeaders.append("Content-Type", "application/json");

  var raw = JSON.stringify({
    title: "",
    body: "",
    tags: [""],
    media: "",
  });

  var requestOptions = {
    method: "POST",
    headers: myHeaders,
    body: JSON.stringify({
      title: title,
      body: body,
    }),
    redirect: "follow",
  };

  fetch(`${API_SOCIAL_URL}${SOCIAL_POSTS}${API_POSTS_PARAMS}`, requestOptions)
    .then((response) => response.json())
    .then((getPosts) => {
      addToPosts(getPosts);

      const postsContainer = document.querySelector("#postsContainer");

      let avatarUrl =
        "https://st3.depositphotos.com/1767687/16607/v/450/depositphotos_166074422-stock-illustration-default-avatar-profile-icon-grey.jpg";
      if (validURL(getPosts.author.avatar)) {
        avatarUrl = getPosts.author.avatar;
      }

      const date = new Date(getPosts.created);
      const options = {
        weekday: "long",
        year: "numeric",
        month: "long",
        day: "numeric",
        hour: "2-digit",
        minute: "2-digit",
      };

      if (postsContainer) {
        const newPost = `&lt;li class="d-flex" id="listObject">
        &lt;a class="flex-shrink-0" href="#fakelink">
            &lt;img class="media-object user-message"
                src="${avatarUrl}" alt="Avatar">
        &lt;/a>
        &lt;div class="flex-grow-1 ms-3">
            &lt;h4 class="fs-5">
                &lt;a href="#fakelink">
                    ${getPosts.author.name}
                &lt;/a>
            &lt;/h4>
            &lt;a href="/post.html?post=${getPosts.id}">
                &lt;h5 class"fs-5">
                    ${getPosts.title}
                &lt;/h5>
            &lt;/a>
            &lt;h6 class="fs-6">
                &lt;small>
                    ${date.toLocaleDateString("en-US", options)}
                &lt;/small>
            &lt;/h6>
            &lt;p>
                ${getPosts.body}
            &lt;/p>
            &lt;hr>
        &lt;/div>
    &lt;/li>`;

        postsContainer.insertAdjacentHTML("afterbegin", newPost);
        postForm.reset();
      }
    })
    .catch((error) => console.log("error", error));
}

const postForm = document.getElementById("createPost");

if (postForm) {
  postForm.addEventListener("submit", submitPost);
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#addUpdate">addUpdate</a></li><li><a href="global.html#addUpdateForm">addUpdateForm</a></li><li><a href="global.html#deletePost">deletePost</a></li><li><a href="global.html#initSearchForm">initSearchForm</a></li><li><a href="global.html#login">login</a></li><li><a href="global.html#loginUser">loginUser</a></li><li><a href="global.html#myHeaders">myHeaders</a></li><li><a href="global.html#navItems">navItems</a></li><li><a href="global.html#register">register</a></li><li><a href="global.html#renderComments">renderComments</a></li><li><a href="global.html#renderPost">renderPost</a></li><li><a href="global.html#renderPosts">renderPosts</a></li><li><a href="global.html#search">search</a></li><li><a href="global.html#submitPost">submitPost</a></li><li><a href="global.html#submitUpdatedPost">submitUpdatedPost</a></li><li><a href="global.html#updatePost">updatePost</a></li><li><a href="global.html#validURL">validURL</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.11</a> on Wed Oct 12 2022 15:16:14 GMT+0200 (Central European Summer Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
